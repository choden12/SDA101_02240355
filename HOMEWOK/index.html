<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Toggle Button</title>
</head>
<body>

<toggle-button></toggle-button>

<script>
  class ToggleButton extends HTMLElement {
    constructor() {
      super();

      // Initialize the button and state
      this.button = document.createElement("button");
      this.state = localStorage.getItem("toggleState") === "true";

      this.updateButton();
      this.button.addEventListener("click", () => this.toggle());

      // Attach button to the custom element
      this.attachShadow({ mode: "open" });
      this.shadowRoot.appendChild(this.button);
    }

    toggle() {
      // Toggle the state and save it to localStorage
      this.state = !this.state;
      localStorage.setItem("toggleState", this.state);

      // Update the button appearance
      this.updateButton();

      // Dispatch the custom event
      this.dispatchEvent(new CustomEvent("toggle-changed", { detail: { state: this.state } }));
    }

    updateButton() {
      // Update button text and color based on state
      this.button.textContent = this.state ? "ON" : "OFF";
      this.button.style.backgroundColor = this.state ? "green" : "red";
      this.button.style.color = "white";
      this.button.style.padding = "10px 20px";
      this.button.style.fontSize = "16px";
    }
  }

  // Define the custom element
  customElements.define("toggle-button", ToggleButton);
</script>

</body>
</html>
